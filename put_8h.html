<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>libdht: /home/travis/build/naturalpolice/libdht/include/dht/put.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libdht
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_e7d75a8427fafea27b500c59b0da00f9.html">dht</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">put.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Get or put mutable/immutable items.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="node_8h_source.html">dht/node.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for put.h:</div>
<div class="dyncontent">
<div class="center"><img src="put_8h__incl.png" border="0" usemap="#_2home_2travis_2build_2naturalpolice_2libdht_2include_2dht_2put_8h" alt=""/></div>
<map name="_2home_2travis_2build_2naturalpolice_2libdht_2include_2dht_2put_8h" id="_2home_2travis_2build_2naturalpolice_2libdht_2include_2dht_2put_8h">
<area shape="rect" id="node2" href="node_8h.html" title="API for running a DHT node. " alt="" coords="106,109,197,136"/>
<area shape="rect" id="node5" href="bencode_8h.html" title="Provides routines for parsing and formating bencoded data. " alt="" coords="227,184,316,211"/>
</map>
</div>
</div>
<p><a href="put_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a7bd97a0c64e00b569ae2a244b27545ee"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="put_8h.html#a7bd97a0c64e00b569ae2a244b27545ee">get_callback</a>) (const struct <a class="el" href="structbvalue.html">bvalue</a> *val, void *opaque)</td></tr>
<tr class="memdesc:a7bd97a0c64e00b569ae2a244b27545ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get complete callback.  <a href="#a7bd97a0c64e00b569ae2a244b27545ee">More...</a><br /></td></tr>
<tr class="separator:a7bd97a0c64e00b569ae2a244b27545ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3f452e0ef0339f4910747536d3936d0"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="put_8h.html#ac3f452e0ef0339f4910747536d3936d0">put_immutable_callback</a>) (int result, void *opaque)</td></tr>
<tr class="memdesc:ac3f452e0ef0339f4910747536d3936d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Put immutable callback.  <a href="#ac3f452e0ef0339f4910747536d3936d0">More...</a><br /></td></tr>
<tr class="separator:ac3f452e0ef0339f4910747536d3936d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae61dc0b96f6d487abbad03fc239241cb"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="put_8h.html#ae61dc0b96f6d487abbad03fc239241cb">put_mutable_callback</a>) (struct <a class="el" href="structbvalue.html">bvalue</a> **val, void *opaque)</td></tr>
<tr class="memdesc:ae61dc0b96f6d487abbad03fc239241cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Put mutable callback.  <a href="#ae61dc0b96f6d487abbad03fc239241cb">More...</a><br /></td></tr>
<tr class="separator:ae61dc0b96f6d487abbad03fc239241cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a90fdafaafd911e8d769f658635b0739e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="put_8h.html#a90fdafaafd911e8d769f658635b0739e">dht_get_immutable</a> (struct <a class="el" href="structdht__node.html">dht_node</a> *node, const unsigned char hash[20], <a class="el" href="put_8h.html#a7bd97a0c64e00b569ae2a244b27545ee">get_callback</a> callback, void *opaque, <a class="el" href="node_8h.html#a75404d24c510013ce7d61dee6d25323b">dht_search_t</a> *handle)</td></tr>
<tr class="memdesc:a90fdafaafd911e8d769f658635b0739e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get an immutable value from the DHT.  <a href="#a90fdafaafd911e8d769f658635b0739e">More...</a><br /></td></tr>
<tr class="separator:a90fdafaafd911e8d769f658635b0739e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae34d30e7907ec1f88ac24709d3fb2ced"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="put_8h.html#ae34d30e7907ec1f88ac24709d3fb2ced">dht_put_immutable</a> (struct <a class="el" href="structdht__node.html">dht_node</a> *node, const struct <a class="el" href="structbvalue.html">bvalue</a> *v, <a class="el" href="put_8h.html#ac3f452e0ef0339f4910747536d3936d0">put_immutable_callback</a> callback, void *opaque, <a class="el" href="node_8h.html#a75404d24c510013ce7d61dee6d25323b">dht_search_t</a> *handle, unsigned char hash[20])</td></tr>
<tr class="memdesc:ae34d30e7907ec1f88ac24709d3fb2ced"><td class="mdescLeft">&#160;</td><td class="mdescRight">Put an immutable value to the DHT.  <a href="#ae34d30e7907ec1f88ac24709d3fb2ced">More...</a><br /></td></tr>
<tr class="separator:ae34d30e7907ec1f88ac24709d3fb2ced"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b46c539b74b72595333e0771a62bc2e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="put_8h.html#a2b46c539b74b72595333e0771a62bc2e">dht_get_mutable</a> (struct <a class="el" href="structdht__node.html">dht_node</a> *node, const unsigned char pubkey[32], const unsigned char *salt, size_t salt_len, <a class="el" href="put_8h.html#a7bd97a0c64e00b569ae2a244b27545ee">get_callback</a> callback, void *opaque, <a class="el" href="node_8h.html#a75404d24c510013ce7d61dee6d25323b">dht_search_t</a> *handle)</td></tr>
<tr class="memdesc:a2b46c539b74b72595333e0771a62bc2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a mutable value from the DHT.  <a href="#a2b46c539b74b72595333e0771a62bc2e">More...</a><br /></td></tr>
<tr class="separator:a2b46c539b74b72595333e0771a62bc2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f283e2abb8b6ab4ed80db9b1256991e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="put_8h.html#a6f283e2abb8b6ab4ed80db9b1256991e">dht_put_mutable</a> (struct <a class="el" href="structdht__node.html">dht_node</a> *node, const unsigned char secret[64], const unsigned char pubkey[32], const unsigned char *salt, size_t salt_len, <a class="el" href="put_8h.html#ae61dc0b96f6d487abbad03fc239241cb">put_mutable_callback</a> callback, void *opaque, <a class="el" href="node_8h.html#a75404d24c510013ce7d61dee6d25323b">dht_search_t</a> *handle)</td></tr>
<tr class="memdesc:a6f283e2abb8b6ab4ed80db9b1256991e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Put an mutable value to the DHT.  <a href="#a6f283e2abb8b6ab4ed80db9b1256991e">More...</a><br /></td></tr>
<tr class="separator:a6f283e2abb8b6ab4ed80db9b1256991e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Get or put mutable/immutable items. </p>
<p>This file contains high-level definitions for storing and retrieving immutable and mutable data from the DHT using the BEP-44 DHT protocol extension. </p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a7bd97a0c64e00b569ae2a244b27545ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* get_callback) (const struct <a class="el" href="structbvalue.html">bvalue</a> *val, void *opaque)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get complete callback. </p>
<p>This callback is called when an immutable or mutable DHT get operation completes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">val</td><td>Value retrieved from the DHT or NULL if none was found or if the search was cancelled. </td></tr>
    <tr><td class="paramname">opaque</td><td>User data pointer passed to <a class="el" href="put_8h.html#a90fdafaafd911e8d769f658635b0739e">dht_get_immutable</a> or <a class="el" href="put_8h.html#a2b46c539b74b72595333e0771a62bc2e">dht_get_mutable</a>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac3f452e0ef0339f4910747536d3936d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* put_immutable_callback) (int result, void *opaque)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Put immutable callback. </p>
<p>This callback is called when an immutable DHT put operation completes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">result</td><td>0 when the operation succeeded, -1 if no nodes were found or the search was cancelled. </td></tr>
    <tr><td class="paramname">opaque</td><td>User data pointer passed to <a class="el" href="put_8h.html#ae34d30e7907ec1f88ac24709d3fb2ced">dht_put_immutable</a>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae61dc0b96f6d487abbad03fc239241cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* put_mutable_callback) (struct <a class="el" href="structbvalue.html">bvalue</a> **val, void *opaque)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Put mutable callback. </p>
<p>This callback is called when a mutable DHT put operation is about to complete, just before sending put queries to the nodes selected to store mutable data. A copy of the data about to be overwritten in the DHT (if any) will be in the location pointed to by <em>val</em>. This gives the callback a chance to choose what data to store in the DHT based on the previous value stored, or to abort the operation altogether. The callback must return the value to be stored in the DHT at the same location. If the content of <em>val</em> is overwritten, it becomes the responsibility of the callee to free the previous pointer. The value found in <em>val</em> will be freed by the library after sending the put queries, unless it is NULL, in which case the put operation will be aborted.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">val</td><td>Pointer to a location containing the previous value retrieved from the DHT, should be updated to the new value to store upon return. NULL if the search was cancelled. </td></tr>
    <tr><td class="paramname">opaque</td><td>User data pointer passed to <a class="el" href="put_8h.html#a6f283e2abb8b6ab4ed80db9b1256991e">dht_put_mutable</a>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a90fdafaafd911e8d769f658635b0739e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dht_get_immutable </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdht__node.html">dht_node</a> *&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char&#160;</td>
          <td class="paramname"><em>hash</em>[20], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="put_8h.html#a7bd97a0c64e00b569ae2a244b27545ee">get_callback</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>opaque</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="node_8h.html#a75404d24c510013ce7d61dee6d25323b">dht_search_t</a> *&#160;</td>
          <td class="paramname"><em>handle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get an immutable value from the DHT. </p>
<p>Start a recursive search for an immutable value matching the given hash on the DHT. The returned handle can be used to cancel the pending search with <a class="el" href="node_8h.html#a5dd051965b69cc2c154fa5ef5c519e12">dht_node_cancel</a>. This function is a wrapper for the low-level <a class="el" href="node_8h.html#a929022d8cc9b1f6d1f4358c66daafa50">dht_node_search</a> function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">node</td><td>The DHT node. </td></tr>
    <tr><td class="paramname">hash</td><td>The target hash of the search. </td></tr>
    <tr><td class="paramname">callback</td><td>Function that will be called with the value retrieved from the DHT when the search is complete. </td></tr>
    <tr><td class="paramname">opaque</td><td>Opaque pointer that will be passed to the callback when the operation completes. </td></tr>
    <tr><td class="paramname">handle</td><td>Pointer to a variable that will receive the search handle. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if the search sucessfully started, or -1 in case of failure. </dd></dl>

</div>
</div>
<a class="anchor" id="a2b46c539b74b72595333e0771a62bc2e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dht_get_mutable </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdht__node.html">dht_node</a> *&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char&#160;</td>
          <td class="paramname"><em>pubkey</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>salt_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="put_8h.html#a7bd97a0c64e00b569ae2a244b27545ee">get_callback</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>opaque</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="node_8h.html#a75404d24c510013ce7d61dee6d25323b">dht_search_t</a> *&#160;</td>
          <td class="paramname"><em>handle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a mutable value from the DHT. </p>
<p>Start a recursive search for an mutable value matching the given public key and salt on the DHT. The returned handle can be used to cancel the pending search with <a class="el" href="node_8h.html#a5dd051965b69cc2c154fa5ef5c519e12">dht_node_cancel</a>. This function is a wrapper for the low-level <a class="el" href="node_8h.html#a929022d8cc9b1f6d1f4358c66daafa50">dht_node_search</a> function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">node</td><td>The DHT node. </td></tr>
    <tr><td class="paramname">pubkey</td><td>The target ed25519 public key of the search. </td></tr>
    <tr><td class="paramname">salt</td><td>The target salt data of the search. </td></tr>
    <tr><td class="paramname">salt_len</td><td>Length of the salt data (max=64). </td></tr>
    <tr><td class="paramname">callback</td><td>Function that will be called with the value retrieved from the DHT when the search is complete. </td></tr>
    <tr><td class="paramname">opaque</td><td>Opaque pointer that will be passed to the callback when the operation completes. </td></tr>
    <tr><td class="paramname">handle</td><td>Pointer to a variable that will receive the search handle. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if the search sucessfully started, or -1 in case of failure. </dd></dl>

</div>
</div>
<a class="anchor" id="ae34d30e7907ec1f88ac24709d3fb2ced"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dht_put_immutable </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdht__node.html">dht_node</a> *&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structbvalue.html">bvalue</a> *&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="put_8h.html#ac3f452e0ef0339f4910747536d3936d0">put_immutable_callback</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>opaque</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="node_8h.html#a75404d24c510013ce7d61dee6d25323b">dht_search_t</a> *&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>hash</em>[20]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Put an immutable value to the DHT. </p>
<p>Start a recursive search for nodes candidates for storing the specified value on the DHT. Once the search completes, the specified completion callback will be called, then put queries will be finally sent to those nodes. This function returns the hash that can be used to retrieve the value stored on the DHT. The returned handle can be used to cancel the pending search with <a class="el" href="node_8h.html#a5dd051965b69cc2c154fa5ef5c519e12">dht_node_cancel</a>. This function is a wrapper for the low-level <a class="el" href="node_8h.html#a929022d8cc9b1f6d1f4358c66daafa50">dht_node_search</a> function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">node</td><td>The DHT node. </td></tr>
    <tr><td class="paramname">v</td><td>The value that will be stored. </td></tr>
    <tr><td class="paramname">callback</td><td>Function that will be called when the operation completes. </td></tr>
    <tr><td class="paramname">opaque</td><td>Opaque pointer that will be passed to the callback when the operation completes. </td></tr>
    <tr><td class="paramname">handle</td><td>Pointer to a variable that will receive the get handle. </td></tr>
    <tr><td class="paramname">hash</td><td>The hash of the stored value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if the search sucessfully started, or -1 in case of failure. </dd></dl>

</div>
</div>
<a class="anchor" id="a6f283e2abb8b6ab4ed80db9b1256991e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dht_put_mutable </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdht__node.html">dht_node</a> *&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char&#160;</td>
          <td class="paramname"><em>secret</em>[64], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char&#160;</td>
          <td class="paramname"><em>pubkey</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>salt_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="put_8h.html#ae61dc0b96f6d487abbad03fc239241cb">put_mutable_callback</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>opaque</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="node_8h.html#a75404d24c510013ce7d61dee6d25323b">dht_search_t</a> *&#160;</td>
          <td class="paramname"><em>handle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Put an mutable value to the DHT. </p>
<p>Start a recursive search for nodes candidates for storing a mutable value for the specified public key and salt on the DHT. Once the search completes, the specified callback will be called with the value currently found on the DHT. The DHT will then be updated with the value returned by the callback. The returned handle can be used to cancel the pending search with <a class="el" href="node_8h.html#a5dd051965b69cc2c154fa5ef5c519e12">dht_node_cancel</a>. This function is a wrapper for the low-level <a class="el" href="node_8h.html#a929022d8cc9b1f6d1f4358c66daafa50">dht_node_search</a> function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">node</td><td>The DHT node. </td></tr>
    <tr><td class="paramname">secret</td><td>The ed25519 secret key used to authenticate put queries. </td></tr>
    <tr><td class="paramname">pubkey</td><td>Public counterpart of <em>secret</em>. </td></tr>
    <tr><td class="paramname">salt</td><td>Salt data to allow multiple stores per public key. </td></tr>
    <tr><td class="paramname">salt_len</td><td>Length of the salt data (max=64). </td></tr>
    <tr><td class="paramname">callback</td><td>Function that will be called before sending put queries. </td></tr>
    <tr><td class="paramname">opaque</td><td>Opaque pointer that will be passed to the callback before sending. </td></tr>
    <tr><td class="paramname">handle</td><td>Pointer to a variable that will receive the search handle. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if the search sucessfully started, or -1 in case of failure. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
