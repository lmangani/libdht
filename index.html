<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>libdht: libdht</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libdht
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">libdht </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://travis-ci.com/naturalpolice/libdht"></a></p>
<p><code>libdht</code> is a C implementation of the Kademlia-based Distributed Hash Table (DHT) used in the BitTorrent network (aka "mainline DHT").</p>
<h2>Features </h2>
<ul>
<li>Full DHT node implementation.</li>
<li>Search peers for an infohash. Announce as peer for an infohash. <a href="https://www.bittorrent.org/beps/bep_0005.html">BEP-5</a></li>
<li>Save/Restore node state and routing table.</li>
<li>Support for DHT Security Extension (node ID hardening). <a href="https://www.bittorrent.org/beps/bep_0042.html">BEP-42</a></li>
<li>Immutable and mutable arbitrary data storage. <a href="https://www.bittorrent.org/beps/bep_0044.html">BEP-44</a></li>
<li>IPv6 support. <a href="https://www.bittorrent.org/beps/bep_0032.html">BEP-32</a></li>
<li>Does not depend on any external component/library.</li>
<li>Independent from the network API, can be used in an event-driven or blocking fashion.</li>
<li>Lua bindings</li>
</ul>
<h2>License </h2>
<p>libdht is distributed under the MIT license (see LICENSE). The present source also incorporates code from the following external projects:</p>
<ul>
<li>Ed25519 implementation based on SUPERCOP "ref10" (<a href="https://github.com/orlp/ed25519">https://github.com/orlp/ed25519</a>). zlib licence.</li>
<li>SHA1 implementation from Mbed TLS (<a href="https://tls.mbed.org">https://tls.mbed.org</a>). Apache 2.0 license.</li>
<li>CRC32C (cagtagnoli) implementation based on Intel's Slicing-by-8 sourceforge project (<a href="https://sourceforge.net/projects/slicing-by-8/">https://sourceforge.net/projects/slicing-by-8/</a>). BSD license.</li>
</ul>
<h2>Dependencies </h2>
<p>libdht only depends on the following libraries:</p>
<ul>
<li>cmocka: Needed for building the unit tests (optional).</li>
<li>lua: Needed for building the lua bindings (optional).</li>
</ul>
<p>It does not require any other external libraries.</p>
<h2>Supported platforms </h2>
<p>So far libdht has been successfully built and tested on:</p>
<ul>
<li>Ubuntu Linux (16.04+)</li>
<li>Windows 10 (MSVC/Visual Studio Build Tools 2017)</li>
</ul>
<h2>Documentation </h2>
<p>Doxygen generated documentation for the library's API is available online at <a href="https://naturalpolice.github.io/libdht/">https://naturalpolice.github.io/libdht/</a>.</p>
<h2>Running a DHT node </h2>
<p>Here is an example to get started operating a basic DHT node. Please refer to the rest of the documentation for more complex scenarios. </p><pre class="fragment">#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;errno.h&gt;
#include &lt;string.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;netinet/in.h&gt;

#include &lt;dht/node.h&gt;

static void sock_send(const unsigned char *data, size_t len,
                      const struct sockaddr *dest, socklen_t addrlen,
                      void *opaque)
{
    int sock = *(int *)opaque;

    if (sendto(sock, data, len, 0, dest, addrlen) &lt; 0)
        fprintf(stderr, "sendto: %s\n", strerror(errno));
}

int node_run(void)
{
    int sock = socket(AF_INET, SOCK_DGRAM, 0);
    struct sockaddr_in sin;
    struct dht_node node;

    sin.sin_family = AF_INET;
    sin.sin_addr.s_addr = INADDR_ANY;
    sin.sin_port = htons(6881);

    bind(sock, (struct sockaddr *)&amp;sin, sizeof(sin));

    if (dht_node_init(&amp;node, NULL, sock_send, &amp;sock))
        return -1;

    dht_node_start(&amp;node);

    while (1) {
        struct timeval tv;
        fd_set rfds;
        int rc;

        FD_ZERO(&amp;rfds);
        FD_SET(sock, &amp;rfds);

        dht_node_timeout(&amp;node, &amp;tv);
        rc = select(sock + 1, &amp;rfds, NULL, NULL, &amp;tv);
        if (rc &lt; 0) {
            fprintf(stderr, "select: %s\n", strerror(errno));
            return -1;
        }
        if (rc &amp;&amp; FD_ISSET(sock, &amp;rfds)) {
            unsigned char buf[2048];
            struct sockaddr_storage ss;
            socklen_t sl = sizeof(ss);

            rc = recvfrom(sock, buf, sizeof(buf), 0, (struct sockaddr *)&amp;ss, &amp;sl);
            if (rc &lt; 0) {
                fprintf(stderr, "recvfrom: %s\n", strerror(errno));
                return -1;
            }

            dht_node_input(&amp;node, buf, rc, (struct sockaddr *)&amp;ss, sl);
        }

        dht_node_work(&amp;node);
    }

    return 0;
}</pre> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
